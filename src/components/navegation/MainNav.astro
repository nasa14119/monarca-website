---
// Components
import { getRelativeLocaleUrl } from "astro:i18n";
import { HamburguerMenu } from "./components/HamburguerMenu";
import { Projects } from "./components/Projects";
import Logo from "@/assets/nav_logo.png";
import Image from "astro/components/Image.astro";
import type { LANGS } from "@types";
import { LINK_PATHS } from "@lib/const";
import ToggleLangDesktop from "@components/navegation/components/LanguageToggle/Desktop";
// currentLocale can't be imported
const currentLocale = (Astro.currentLocale ?? "es") as LANGS;
const linkRelative = (path: string) =>
  getRelativeLocaleUrl(currentLocale, path);
import { getMainLinks, getProjects } from "@components/navegation/links";
import type { ProyectLinks } from "@components/navegation/links";
const desktop_links = getMainLinks(currentLocale);
const projects_links = getProjects(currentLocale);
const poryects_links_realtive = Object.fromEntries(
  Object.entries(projects_links["links"]).map(([key, value]) => [
    key,
    {
      ...value,
      path: linkRelative(value.path),
    },
  ]),
) as ProyectLinks["links"];
const formated_proyect_links: ProyectLinks = {
  ...projects_links,
  links: poryects_links_realtive,
};
---

<nav
  class="z-50 flex justify-between items-center bg-background h-15 md:h-14 pl-[5vw] pr-[4vw] md:px-4 py-2 sticky top-0"
>
  <a
    href={linkRelative(LINK_PATHS["HOME"])}
    class="h-full w-fit py-1 md:p-0 md:-mt-1"
  >
    <Image
      alt="logo ruta monarca"
      src={Logo}
      class="h-full w-fit"
      loading="eager"
    />
  </a>
  <HamburguerMenu
    client:visible
    currentLocale={{ currentLocale, currentPath: Astro.url.pathname }}
  />
  <ul
    class="hidden md:flex justify-end w-full gap-4 h-full items-center pl-2 pt-4"
  >
    {
      Object.values(desktop_links).map((link) => {
        return (
          <li class="desktop">
            <a href={linkRelative(link.path)} aria-label={link.body}>
              {link.body}
            </a>
          </li>
        );
      })
    }
    <Projects links={formated_proyect_links} client:load />
    <ToggleLangDesktop
      client:visible
      currentLocale={{ currentLocale, currentPath: Astro.url.pathname }}
    />
  </ul>
</nav>
<style>
  @reference "@styles/global.css";
  li.desktop,
  :global(.dropTrigger) {
    @apply font-medium uppercase text-sm;
  }
</style>
